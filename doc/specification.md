# ダイヤグラムによるプログラミングについての説明

## 概要

「らららプログラミング」は、先行評価、かつ、手続き型の簡易プログラミング言語です。
ちゃんとしたプログラミング言語([チューリング完全](https://ja.wikipedia.org/wiki/%E3%83%81%E3%83%A5%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0%E5%AE%8C%E5%85%A8)なプログラミング言語)ではありません。
言語についての細かなことをいくつか [ダイヤグラムによるプログラミング言語についての覚え書き](about_language.md) に記載しています。

## スクリプトを書くには(模様の作図の指示を作成する)

字を入力するのではなく、箱を線でつないだ図形の組み合わせでプログラミングします。
(細かな説明は[ここ](./doc/specification.md) を参照してください)

プログラミング時にすることは以下です。

- プログラミング時にすること
    - パラメーター定義の設定
    - ダイヤグラムの作成
- 実行時にすること
    - 実行
    - パラメーターの変更

### ダイヤグラムの作成

### ダイヤグラム部品(アイコン)の配置

左クリックでメニューが表示されます。
メニューから配置したい部品を選びます。

### 線で結ぶ

端子をドラッグすると線が伸び、アイコンとアイコンを結ぶことができます。


## 仕様の細部

### データの型

データの型として以下があります。
- 数値
    - 整数(多倍長整数のみ)
    - 浮動小数点(倍精度のみ)
    - 任意精度の小数
- ブール値
- 文字列
- 点(座標)のリスト
- 線分(2点間を結ぶ線分)のリスト
- 2次元のアフィン変換(線形変換)
- 色情報

### 変数について

データの型に挙げた数や、演算子は値を持ちます。
値には変数名を割り当てることができます。
割り当てた変数名を使い、別の場所で値を取り出すことができます。
変数名には別の値を割り当てなおすことができます。

変数名は以下のルールを満たすものが使えます。
変数名は半角スペースと記号以外は使用可能です。
<ul>
<li> 英数字は使用可能。ただし、数字で始まるものは許可しない
<li> アンダーバーは許可。アンダーバー以外の記号は許可しない。
<li> 漢字・ひらがな・カタカナなどの非ASCII文字は全て許可。
<li> (ギリシャ文字 α, β, γ, ... が使用可能)
</ul>

通常のプログラミング言語では記号を演算子の目的で使うので、これを真似て、変数名に許可していません。

Unicodeの非ASCII文字はすべて許可しています。
(ギリシャ文字のθやαを使用したい状況を想定しています。
絵文字はフォントの関係で使えません)

テキストで記述するプログラミング言語では、変数の定義時と参照時でまぎらわしい別の文字を使ってしまうと
参照できない誤りが発生しますが、マウス操作で選択肢の中から選ぶのであればそれはないため。


#### 数値について

数値については、整数と実数を取り扱う型があります。
実数は2種類あり、浮動小数点によるものと、任意精度によるものがあります。

浮動小数点は、十進数で約16桁(15.9桁)の精度があり、絶対値で 10^(-300) から 10^300 の大きさの数が取り扱えます。
内部的にはJavaのdoubleを使用しています。
( [IEEE754のbinary64](https://ja.wikipedia.org/wiki/IEEE_754) や [倍精度浮動小数点数](https://ja.wikipedia.org/wiki/%E5%80%8D%E7%B2%BE%E5%BA%A6%E6%B5%AE%E5%8B%95%E5%B0%8F%E6%95%B0%E7%82%B9%E6%95%B0) を参照してください )

整数は、JavaのBigInteger を使用しています。
公式のドキュメント https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigInteger.html によると、扱える範囲は -(2^(2^31-1) - 1) から (2^(2^31-1) - 1) とのことです。
つまり、仕様上の限界値としては 十進数で 646,456,992.9桁になります( log10(2) × (2^31 - 1) 桁)。
全ての桁の精度があるため、桁数に比例してメモリーが必要になります。
起動するときのヒープメモリーの限界値に注意してください。

任意精度の小数は、JavaのBigDecimal を使用しています。
細かな話は https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigDecimal.html を参照してください。

数値と数値の演算は、型が異なる場合は型変換を行います。
型変換の規則は以下です。
- 整数と任意精度の小数 → 任意精度の小数
- 整数と浮動小数点 → 浮動小数点
- 任意精度の小数と浮動小数点 → 浮動小数点

#### 色情報について

32bit + 透過度8bit の情報を保持しています。

### パラメーターを定義する

プログラムを実行するときのパラメーター設定を定義することができます。
パラメーターは、プログラムの実行時に、変数の初期値として設定されます。
パラメーターの値が設定された変数は、書き換えが可能です。
データの型のうち、以下をパラメーターとすることができます(定数として直接できるもの)。

- 数値
    - 整数
    - 浮動小数点
    - 任意精度の小数
- ブール値
- 文字列

パラメーターは、パラメーター定義の一覧画面(以下の図)で追加することができます。
![パラメーター定義の一覧画面](./image/param_def_list_window.png "キャプチャ(パラメーター定義の一覧画面)")

「新しいパラメーターを追加」の文字をクリックするとパラメーターの定義画面が表示されます。
![パラメーターの定義画面](./image/param_def_window.png "キャプチャ(パラメーターの定義画面)")

以下を設定し、「これに決める」ボタンをクリックします。
- 変数名
- 説明
- 型
- デフォルト値

## プログラムを実行する

### 実行

プルダウンメニューから実行を選びます。
![「実行」ボタン](./image/excecute_button.png "キャプチャ(「実行」ボタン)")


### 実行時のパラメーター設定

パラメーターはプログラムの実行時に入力可能で、初期値としてパラメーター定義において指定されたデフォルト値が設定されています。
これを変化させると、それに応じて画面が変化します。

---------------------------------------
[README.mdに戻る](../README.md)

